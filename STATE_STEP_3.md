## To Do:
 - Basically, copy-paste most of step 2, then:
     - Change the training step to:
        1. Generate the scratchpads
        2. Marginalize over them
     - Change the loss
     - Save the output tokens elsewhere